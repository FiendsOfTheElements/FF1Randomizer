.include "Constants.inc"
.include "variables.inc"

lut_ExpToAdvance = $8C81
;bank 1B
;original level up code
;LvlUp_GetExpToAdvance  [$886E :: 0x6C87E]
.org $886E
LvlUp_GetExpToAdvance:
    JSR LvlUp_GetExpExt
    RTS

;20 18 95 60

;bank 1B
.org $9500

;lut_ClassAltXp  [$9500 :: 0x6D510]
;fighter just uses the original xp table
lut_ClassAltXpTableAddress:
    .word lut_ExpToAdvance, lut_ExpToAdvanceThief, lut_ExpToAdvanceBlackBelt, lut_ExpToAdvanceRedMage, lut_ExpToAdvanceWhiteMage, lut_ExpToAdvanceBlackMage
    .word lut_ExpToAdvance, lut_ExpToAdvanceThief, lut_ExpToAdvanceBlackBelt, lut_ExpToAdvanceRedMage, lut_ExpToAdvanceWhiteMage, lut_ExpToAdvanceBlackMage

;81 8C 35 95 C8 95 5B 96 EE 96 81 97 81 8C 35 95 C8 95 5B 96 EE 96 81 97

;LvlUp_GetExpExt  [$9518 :: 0x6D528]
LvlUp_GetExpExt:
    ;load the class
    LDY #ch_class - ch_stats
    LDA (lvlup_chstats), Y
    ASL A
    TAX
    
    ; get their level
    LDY #ch_level - ch_stats    
    LDA (lvlup_chstats), Y
    ASL A
    CLC
    ADC (lvlup_chstats), Y                ; A = level*3

    CLC
    ADC lut_ClassAltXpTableAddress,X
    STA lvlup_exptoadv
    INX
    LDA #$00
    ADC lut_ClassAltXpTableAddress,X
    STA lvlup_exptoadv+1

    RTS

; A0 00 B1 86 0A AA A0 26 B1 86 0A 18 71 86 18 7D 00 95 85 82 E8 A9 00 7D 00 95 85 83 60
lut_ExpToAdvanceThief:
  .FARADDR     40,    196,    547,   1171,   2146,   3550,   5461,   7957,  11116,  15016
  .FARADDR  19735,  25351,  31942,  39586,  48361,  58345,  69617,  82253,  96332, 111932
  .FARADDR 129131, 148008, 168639, 191103, 215479, 241843, 270275, 300851, 333651, 366450
  .FARADDR 399250, 432049, 464849, 497648, 530448, 563247, 596047, 628846, 661646, 694445
  .FARADDR 727245, 760044, 792844, 825643, 858443, 891242, 924042, 956841, 989641
; 28 00 00 C4 00 00 23 02 00 93 04 00 62 08 00 DE 0D 00 55 15 00 15 1F 00 6C 2B 00 A8 3A 00 17 4D 00 07 63 00 C6 7C 00 A2 9A 00 E9 BC 00 E9 E3 00 F1 0F 01 4D 41 01 4C 78 01 3C B5 01 6B F8 01 28 42 02 BF 92 02 7F EA 02 B7 49 03 B3 B0 03 C3 1F 04 33 97 04 53 17 05 72 97 05 92 17 06 B1 97 06 D1 17 07 F0 97 07 10 18 08 2F 98 08 4F 18 09 6E 98 09 8E 18 0A AD 98 0A CD 18 0B EC 98 0B 0C 19 0C 2B 99 0C 4B 19 0D 6A 99 0D 8A 19 0E A9 99 0E C9 19 0F

lut_ExpToAdvanceBlackBelt:
  .FARADDR     40,    196,    547,   1171,   2146,   3550,   5461,   7957,  11116,  15016
  .FARADDR  19735,  25351,  31942,  39586,  48361,  58345,  69617,  82253,  96332, 111932
  .FARADDR 129131, 148008, 168639, 191103, 215479, 241843, 270275, 300851, 333651, 366450
  .FARADDR 399250, 432049, 464849, 497648, 530448, 563247, 596047, 628846, 661646, 694445
  .FARADDR 727245, 760044, 792844, 825643, 858443, 891242, 924042, 956841, 989641
; 28 00 00 C4 00 00 23 02 00 93 04 00 62 08 00 DE 0D 00 55 15 00 15 1F 00 6C 2B 00 A8 3A 00 17 4D 00 07 63 00 C6 7C 00 A2 9A 00 E9 BC 00 E9 E3 00 F1 0F 01 4D 41 01 4C 78 01 3C B5 01 6B F8 01 28 42 02 BF 92 02 7F EA 02 B7 49 03 B3 B0 03 C3 1F 04 33 97 04 53 17 05 72 97 05 92 17 06 B1 97 06 D1 17 07 F0 97 07 10 18 08 2F 98 08 4F 18 09 6E 98 09 8E 18 0A AD 98 0A CD 18 0B EC 98 0B 0C 19 0C 2B 99 0C 4B 19 0D 6A 99 0D 8A 19 0E A9 99 0E C9 19 0F

lut_ExpToAdvanceRedMage:
  .FARADDR     40,    196,    547,   1171,   2146,   3550,   5461,   7957,  11116,  15016
  .FARADDR  19735,  25351,  31942,  39586,  48361,  58345,  69617,  82253,  96332, 111932
  .FARADDR 129131, 148008, 168639, 191103, 215479, 241843, 270275, 300851, 333651, 366450
  .FARADDR 399250, 432049, 464849, 497648, 530448, 563247, 596047, 628846, 661646, 694445
  .FARADDR 727245, 760044, 792844, 825643, 858443, 891242, 924042, 956841, 989641
; 28 00 00 C4 00 00 23 02 00 93 04 00 62 08 00 DE 0D 00 55 15 00 15 1F 00 6C 2B 00 A8 3A 00 17 4D 00 07 63 00 C6 7C 00 A2 9A 00 E9 BC 00 E9 E3 00 F1 0F 01 4D 41 01 4C 78 01 3C B5 01 6B F8 01 28 42 02 BF 92 02 7F EA 02 B7 49 03 B3 B0 03 C3 1F 04 33 97 04 53 17 05 72 97 05 92 17 06 B1 97 06 D1 17 07 F0 97 07 10 18 08 2F 98 08 4F 18 09 6E 98 09 8E 18 0A AD 98 0A CD 18 0B EC 98 0B 0C 19 0C 2B 99 0C 4B 19 0D 6A 99 0D 8A 19 0E A9 99 0E C9 19 0F

lut_ExpToAdvanceWhiteMage:
  .FARADDR     40,    196,    547,   1171,   2146,   3550,   5461,   7957,  11116,  15016
  .FARADDR  19735,  25351,  31942,  39586,  48361,  58345,  69617,  82253,  96332, 111932
  .FARADDR 129131, 148008, 168639, 191103, 215479, 241843, 270275, 300851, 333651, 366450
  .FARADDR 399250, 432049, 464849, 497648, 530448, 563247, 596047, 628846, 661646, 694445
  .FARADDR 727245, 760044, 792844, 825643, 858443, 891242, 924042, 956841, 989641
; 28 00 00 C4 00 00 23 02 00 93 04 00 62 08 00 DE 0D 00 55 15 00 15 1F 00 6C 2B 00 A8 3A 00 17 4D 00 07 63 00 C6 7C 00 A2 9A 00 E9 BC 00 E9 E3 00 F1 0F 01 4D 41 01 4C 78 01 3C B5 01 6B F8 01 28 42 02 BF 92 02 7F EA 02 B7 49 03 B3 B0 03 C3 1F 04 33 97 04 53 17 05 72 97 05 92 17 06 B1 97 06 D1 17 07 F0 97 07 10 18 08 2F 98 08 4F 18 09 6E 98 09 8E 18 0A AD 98 0A CD 18 0B EC 98 0B 0C 19 0C 2B 99 0C 4B 19 0D 6A 99 0D 8A 19 0E A9 99 0E C9 19 0F

lut_ExpToAdvanceBlackMage:
  .FARADDR     40,    196,    547,   1171,   2146,   3550,   5461,   7957,  11116,  15016
  .FARADDR  19735,  25351,  31942,  39586,  48361,  58345,  69617,  82253,  96332, 111932
  .FARADDR 129131, 148008, 168639, 191103, 215479, 241843, 270275, 300851, 333651, 366450
  .FARADDR 399250, 432049, 464849, 497648, 530448, 563247, 596047, 628846, 661646, 694445
  .FARADDR 727245, 760044, 792844, 825643, 858443, 891242, 924042, 956841, 989641
; 28 00 00 C4 00 00 23 02 00 93 04 00 62 08 00 DE 0D 00 55 15 00 15 1F 00 6C 2B 00 A8 3A 00 17 4D 00 07 63 00 C6 7C 00 A2 9A 00 E9 BC 00 E9 E3 00 F1 0F 01 4D 41 01 4C 78 01 3C B5 01 6B F8 01 28 42 02 BF 92 02 7F EA 02 B7 49 03 B3 B0 03 C3 1F 04 33 97 04 53 17 05 72 97 05 92 17 06 B1 97 06 D1 17 07 F0 97 07 10 18 08 2F 98 08 4F 18 09 6E 98 09 8E 18 0A AD 98 0A CD 18 0B EC 98 0B 0C 19 0C 2B 99 0C 4B 19 0D 6A 99 0D 8A 19 0E A9 99 0E C9 19 0F
